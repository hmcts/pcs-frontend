{% extends "stepsTemplate.njk" %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}

{% block pageTitle %}{{ pageTitle }} - HM Courts & Tribunals Service â€“ GOV.UK{% endblock %}

{% block mainContent %}
  {% if errorSummary %}
    {{ govukErrorSummary(errorSummary) }}
  {% endif %}
  <h1 class="govuk-heading-l">
    <span class="govuk-caption-xl">{{ caption }}</span>
    {{ heading }}
  </h1>
  {# Form #}
  <form method="post" action="{{ url }}" novalidate>
    {# Group related text inputs with a fieldset/legend (not the page heading) #}
    {% if heading %}
      {% call govukFieldset({
        legend: {
          text: heading,
          classes: "govuk-visually-hidden"
        }
      }) %}
        {% for field in fields %}
          {% if field.component and field.componentType == 'input' %}
            {{ govukInput(field.component) }}
          {% endif %}
        {% endfor %}
      {% endcall %}
    {% else %}
      {# Fallback: render inputs without a legend #}
      {% for field in fields %}
        {% if field.component and field.componentType == 'input' %}
          {{ govukInput(field.component) }}
        {% endif %}
      {% endfor %}
    {% endif %}

    {# Button group #}
    <div class="govuk-button-group">
      {# Save and continue #}
      {{ govukButton({
        text: continue or t('buttons.continue', { ns: 'common' }),
        attributes: {
          type: 'submit',
          name: 'action',
          value: 'continue'
        }
      }) }}

      {# Save for later #}
      {{ govukButton({
        text: saveForLater or t('buttons.saveForLater', { ns: 'common' }),
        classes: 'govuk-button--secondary',
        attributes: {
          type: 'submit',
          name: 'action',
          value: 'saveForLater'
        }
      }) }}
    </div>
  </form>
{% endblock %}
